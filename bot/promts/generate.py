import json
import aiohttp
from .fix_json import fix_and_parse_json
from .check import check
import os
from dotenv import load_dotenv


load_dotenv()
GEMINI_ENDPOINT = os.getenv("GEMINI_ENDPOINT")
mass = '''
ุชุตุงูุฑ ุดูุง ุจุง ููููุช ุฏุฑูู ฺฉุงูุงู ูุฑุงุฑ ฺฏุฑูุชู :

https://t.me/MahoAi_image
'''

PRECISE_JSON = """
{
    "prompt": "",
    "accurate": true,
    "remove": false,
    "steps": 8,
}
"""

CREATIVE_JSON = """
{
    "prompt": "",
    "accurate": false,
    "remove": false,
    "negative_prompt": "",
    "width": 1024,
    "height": 1024,
    "steps": 20,
    "guidance": 12,
    "seed": 52
}
"""

async def generate_prompts(user_text, mode="precise"):
    if mode == "precise":
        base_json = PRECISE_JSON
    else:
        base_json = CREATIVE_JSON

    prompts_js = await check(user_text)
    Advertising = prompts_js["Advertising"]
    caption = prompts_js["caption"]
    nudity = prompts_js["nudity"]
    Suggestions = json.dumps(prompts_js["Suggestions"], ensure_ascii=False, indent=4)

    if nudity:
        return [], caption, Advertising

    base_json2 = """
 {
    "prompts": [],
    "caption": ""
}
"""
    list1= f"""ุชูุฌู: ุจุฑุง ุฒุจุง ูุฑฺู ุจุดุชุฑ ูพุฑุงูุช ุงุฒ ูุณุช ูพุดููุงุฏ ุฒุฑ ฺฉูฺฉ ุจฺฏุฑ:
                           {Suggestions}
    """
    nokte = """
           ูฺฉุงูุช ฺฉู ุจุฑุง ุชููุฏ ฺฉ ูพุฑุงูุช ุฎูุจ ุจุงุฏ ุฏุฑ ูุธุฑ ุจฺฏุฑ:[
                         ๐น ุงูุฒุงุด ุนูู ูู ุจุง ุงุตุทูุงุญุงุช ุณููุง/ุนฺฉุงุณ:
                        โ ููุฑูพุฑุฏุงุฒ ูพุดุฑูุชู:
                        Subsurface Scattering (SSS) โ ุจุฑุง ุทุจุนโุชุฑ ฺฉุฑุฏู ูพูุณุช ู ููุงุฏ ูููโุดูุงู
                        Volumetric Lighting โ ููุฑ ุญุฌู ุจุฑุง ููุงุด ูพุฑุชููุง ููุฑ ู ูู
                        Global Illumination (GI) โ ููุฑูพุฑุฏุงุฒ ุณุฑุงุณุฑ ุจุฑุง ูุงูุนโุชุฑ ุดุฏู ุณุงูโูุง
                        Ambient Occlusion (AO) โ ุณุงูโูุง ูุญุท ุจุฑุง ุงูุฒุงุด ุนูู
                        Ray Tracing โ ูุญุงุณุจู ุฏูู ุจุงุฒุชุงุจโูุง ู ุงูฺฉุณุงุฑูุง ููุฑ
                        Caustics โ ุจุงุฒุชุงุจโูุง ููุฑ ุฑู ุขุจ ู ุดุดู
                        โ ุงูฺฉุชโูุง ููุฒ ู ุดุจูโุณุงุฒ ุฏูุฑุจู:
                        Chromatic Aberration โ ุงูุญุฑุงู ุฑูฺฏ ุจุฑุง ุญุณ ุณููุง
                        Depth of Field (DOF) โ ูุญู ฺฉุฑุฏู ูพุณโุฒููู ุจุฑุง ุฌุฏุงุณุงุฒ ุณูฺู
                        Bokeh Shapes โ ุชูุธู ุดฺฉู ุจูฺฉู (ุฏุงุฑูโุงุ ฺูุฏุถูุนุ ุขูุงููุฑูฺฉ)
                        Anamorphic Lens Flare โ ุจุงุฒุชุงุจโูุง ูุฎุตูุต ููุฒูุง ุณููุง
                        Film Grain & Noise โ ุดุจูโุณุงุฒ ููุฒ ููู ุจุฑุง ุญุณ ุทุจุนโุชุฑ
                        Motion Blur โ ุชุงุฑ ุญุฑฺฉุช ุจุฑุง ุญุณ ุณุฑุนุช ู ูพูุง
                        Long Exposure โ ููุฑุฏู ุทููุงู ุจุฑุง ุฌูููโูุง ุฎุงุต ูุซู ุฑุฏ ููุฑ ุฎูุฏุฑู
                        โ ูุฏูโุณุงุฒ ู ูุฒฺฉ ููุฑ:
                        PBR Materials (Physically Based Rendering) โ ูุชุฑุงูโูุง ูุจุชู ุจุฑ ูุฒฺฉ
                        Subpixel Rendering โ ุงูุฒุงุด ุฏูุช ููุงุด ุฌุฒุฆุงุช
                        Light Falloff & Soft Shadows โ ูุญุงุณุจู ุงูุช ููุฑ ู ุณุงูโูุง ูุฑู
                        Exposure Control โ ฺฉูุชุฑู ูุฒุงู ููุฑุฏู ุจุฑุง ุชุฃุซุฑ ุงุญุณุงุณ ุจุดุชุฑ
                        ๐น ุงุชุตุงู ุนูุงุตุฑ ุจู ุญุณ ู ููููู:
                        โ ุฑูฺฏ ู ุงุญุณุงุณ:
                        ุฑูฺฏโูุง ุณุฑุฏ (ุขุจุ ุฎุงฺฉุณุชุฑุ ุจููุด ฺฉูโุฑูฺฏ) โ ุงุญุณุงุณ ุชููุงุ ุชุฑุณุ ุง ุฑูุฒุขููุฏฺฏ
                        ุฑูฺฏโูุง ฺฏุฑู (ูุฑูุฒุ ูุงุฑูุฌุ ุทูุง) โ ุญุณ ุงูุฑฺุ ุฎุดูุ ุง ุตููุช
                        ุฑูฺฏ ุณุจุฒ โ ุขุฑุงูุดุ ุทุจุนุชุ ุง ุญุณ ูุฑุงูุงูุน
                        ุชุถุงุฏ ุดุฏุฏ ุจู ููุฑ ู ุชุงุฑฺฉ โ ุฏูฺฏุงูฺฏ ุฎุฑ ู ุดุฑ
                        ุงุณุชูุงุฏู ุงุฒ ูู ู ููุฑ ฺฉู โ ุญุณ ุฑูุฒุขููุฏ ู ูุจูู
                        โ ุฒุงูู ุฏูุฑุจู ู ุญุณ ุขู:
                        ุฒุงูู ูพุงู (Low Angle) โ ููุงุด ูุฏุฑุช ู ุชุณูุท
                        ุฒุงูู ุจุงูุง (High Angle) โ ููุงุด ุถุนู ู ฺฉูฺฺฉ ุดุฎุตุช
                        ููุง ุจุณุชู (Close-up) โ ุชุฃฺฉุฏ ุจุฑ ุงุญุณุงุณุงุช ู ูุงฺฉูุดโูุง
                        ููุง ูููโุนุฑุถ (Extreme Wide Shot) โ ูุดุงู ุฏุงุฏู ูุงฺุฒ ุจูุฏู ุดุฎุตุช ุฏุฑ ูุญุท
                        โ ููุฑูพุฑุฏุงุฒ ุงุญุณุงุณ:
                        ููุฑ ูุฑู ู ูพุฎุดโุดุฏู โ ุตููุชุ ุขุฑุงูุดุ ุง ุญุณ ุฑูุง
                        ููุฑ ุณุฎุช ุจุง ุณุงูโูุง ุชุฒ โ ุชูุดุ ุชุฑุณุ ุง ุงุณุชุฑุณ
                        ููุฑ ูพุณโุฒููู (Backlight) โ ุญุณ ุฑูุฒุขููุฏ ุง ุฏุฑุงูุงุชฺฉ
                        ููุฑูพุฑุฏุงุฒ ฺฉูโฺฉูุชุฑุงุณุช (Low Contrast Lighting) โ ุญุณ ูุงูุฎููุง ุง ุณุฑุฏุฑฺฏู
                        ๐น ุงุณุชุฑุงุชฺโูุง ฺฉูุชุฑู ุฎุฑูุฌ AI:
                        Gradient-based Attention Weighting โ ฺฉูุชุฑู ุชูุฑฺฉุฒ ูุฏู ุฏุฑ ููุงุญ ุฎุงุต
                        Multi-pass Refinement โ ูพุฑุฏุงุฒุด ฺูุฏ ูุฑุญููโุง ุจุฑุง ุงูุฒุงุด ฺฉูุช
                        Seed Control & Variability Reduction โ ฺฉูุชุฑู ุฎุฑูุฌ ุชุตุงุฏู ุจุฑุง ูุชุงุฌ ูุดุงุจู
                        Latent Space Navigation โ ูุฏุงุช ูุฏู ุฏุฑ ูุถุง ูฺฺฏโูุง ุจุฑุง ุฎุฑูุฌ ุฎุงุตโุชุฑ
                        Negative Prompting โ ุฌููฺฏุฑ ุงุฒ ุชููุฏ ุนูุงุตุฑ ูุงุฎูุงุณุชู
                        ๐น ููุงุฏฺฏุฑุง ุฑูุง ุจุฑุง ุงูุชูุงู ููุงูู ุงูุชุฒุงุน:
                        ุขูู โ ุฎูุฏุดูุงุณุ ุชุถุงุฏ ุฏุฑูู
                        ุณุงูโูุง ฺฉุดุฏู โ ุชูุฏุฏุ ูุงุงูู
                        ุฏุงุฑู ู ุญููู โ ุจโูพุงุงูุ ฺุฑุฎูโูุง ุฒูุงู
                        ุฒูุฌุฑ ู ุทูุงุจ โ ูุญุฏูุฏุชุ ุงุณุงุฑุชุ ุง ุงุฑุชุจุงุท ุนุงุทู
                        ุงูุนฺฉุงุณ ุฏุฑ ุขุจ โ ูุงูุนุช ููุงุฒ ุง ุฏูฺฏุงูฺฏ ุดุฎุตุช
                        ๐น ุจูููโุณุงุฒ ูุงฺฺฏุงู ุจุฑุง ฺฉุงูุด ุงุจูุงู:
                        โ ุงุตุทูุงุญุงุช ุณููุง:
                        35mm f/1.4 Lens โ ุจุฑุง ูพุฑุชุฑูโูุง ุญุฑููโุง
                        14mm f/2.8 Lens โ ุจุฑุง ุซุจุช ฺุดูโุงูุฏุงุฒูุง ุณููุง
                        3200K Warm Light โ ุจุฑุง ููุฑ ุทูุง ู ุตููุงูู
                        5600K Daylight โ ููุฑ ุทุจุน ู ูุชุนุงุฏู
                        โ ุณุจฺฉโูุง ุณููุง:
                        Film Noir โ ุชุงุฑฺฉ ู ุณุงูโูุง ุนูู ุจุฑุง ูุถุง ูุนูุง
                        Cyberpunk โ ููุฑูุง ูุฆูู ุจุง ุชุฑฺฉุจ ุชฺฉููููฺ ู ุฏุณุชููพุง
                        Gothic Horror โ ุงุณุชูุงุฏู ุงุฒ ูุนูุงุฑ ุชุงุฑฺฉ ู ูู ุจุฑุง ุชุฑุณ ู ูุญุดุช
                        ๐น ฺฉูพุงุฑฺูโุณุงุฒ ูุญุฏูุฏุชโูุง ุตุฑุญ ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฎุฑูุฌ ูุงุฎูุงุณุชู:
                        ูุญุฏูุฏ ฺฉุฑุฏู ุฑูฺฏโูุง ุบุฑูุงูุน ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุงูฺฉุชโูุง ุนุฌุจ
                        ฺฉูุชุฑู ุจุดุชุฑู ู ฺฉูุชุฑู ูุฒุงู ุฌุฒุฆุงุช ุฏุฑ ุชุตูุฑ
                        ุฌููฺฏุฑ ุงุฒ ุงุนูุฌุงุฌ ุบุฑูุงูุน ุฏุฑ ูพุฑุณูพฺฉุชู ุดุฎุตุชโูุง
                        ๐น ูุงูโุจูุฏ ุณูโุจุนุฏ ูุญุท:
                        ูพุดโุฒููู (Foreground): ุนูุงุตุฑ ูุฒุฏฺฉ ุจู ุฏูุฑุจู ฺฉู ุญุณ ุนูู ูโุฏููุฏ
                        ูุงูโุฒููู (Midground): ุณูฺู ุงุตู ฺฉู ุชูุฑฺฉุฒ ุฑู ุขู ุงุณุช
                        ูพุณโุฒููู (Background): ุงุฌุงุฏ ูุถุง ูุญุท ู ุญุณ ููุงุณ
                        ๐น ุงูุฒูุฏู ุงุตูู ุชุฑฺฉุจโุจูุฏ ุณููุง:
                        โ ุชฺฉูฺฉโูุง ูุงุจโุจูุฏ:
                        Rule of Thirds โ ุชูุณู ูุงุจ ุจู น ูุณูุช ุจุฑุง ุชุนุงุฏู ุจุตุฑ
                        Leading Lines โ ูุฏุงุช ฺุดู ุจููุฏู ุจุง ุฎุทูุท ุฑุงูููุง
                        Golden Ratio โ ุงุณุชูุงุฏู ุงุฒ ูุณุจุช ุทูุง ุจุฑุง ุชุฑฺฉุจโุจูุฏ ุทุจุน
                        Dutch Angle โ ฺฉุฌ ฺฉุฑุฏู ูุงุจ ุจุฑุง ุงุฌุงุฏ ุญุณ ุงุถุทุฑุงุจ
                        โ ุงุณุชูุงุฏู ุงุฒ ูุถุง ููู:
                        Negative Space โ ุญุฐู ุงููุงูโูุง ุบุฑุถุฑูุฑ ุจุฑุง ุชุฃฺฉุฏ ุฑู ุณูฺู
                        โ ุชฺฉูฺฉโูุง ฺฉูุชุฑุงุณุช:
                        High Contrast โ ููุงุด ุฏูฺฏุงูฺฏ ู ุชูุด ุจุงูุง
                        Soft Contrast โ ุงุฌุงุฏ ุญุณ ุฑูุง ู ูุทู
                        ๐น ุงุฌุงุฏ ุญุณ ุญุฑฺฉุช ู ูพูุง ุฏุฑ ุตุญูู:
                        โ ุงูฺฉุชโูุง ุณููุง ุจุฑุง ููุงุด ุญุฑฺฉุช:
                        Motion Blur โ ุชุงุฑ ุญุฑฺฉุช ุจุฑุง ุญุณ ุณุฑุนุช
                        Parallax Scrolling โ ุงุฎุชูุงูโููุธุฑ ุจุฑุง ุนูู ุจุดุชุฑ
                        Dynamic Lighting โ ููุฑูพุฑุฏุงุฒ ูุชุญุฑฺฉ ุจุฑุง ุชุฃุซุฑ ุงุญุณุงุณ
                        โ ุงูฺฉุชโูุง ุฎุงุต ุจุฑุง ุชุฃุซุฑฺฏุฐุงุฑ ุจุดุชุฑ:
                        Long Exposure Photography โ ุซุจุช ุญุฑฺฉุช ููุฑูุง ุฏุฑ ุดุจ
                        Tilt-shift Effect โ ุงุฌุงุฏ ุงูฺฉุช ููุงุชูุฑ
                        Dual-focus Composition โ ุฏู ููุทู ููฺฉูุณ ููุฒูุงู
                        โ ุชฺฉูฺฉโูุง ููุฑูพุฑุฏุงุฒ ุฎุงุต:
                        Underexposure โ ฺฉูโููุฑุฏู ุจุฑุง ุญุณ ุฑุงุฒุขููุฏ
                        Overexposure โ ููุฑ ุจุด ุงุฒ ุญุฏ ุจุฑุง ุงุฌุงุฏ ุญุณ ุงุณุชุฑุณ ุง ุณุฑฺฏุฌู
                        ๐น ุงุณุชูุงุฏู ุงุฒ ุจุงูุชโูุง ู ูุฒฺฉ ููุฑ ุจุฑุง ุนูู ุจุดุชุฑ:
                        Microdetail Mapping โ ุงุถุงูู ฺฉุฑุฏู ุจุงูุชโูุง ุจุณุงุฑ ุฑุฒ
                        Ray-traced Shadows โ ุณุงูโูุง ูุงูุนโฺฏุฑุงุงูู ู ุฏูู
                        Soft Diffusion Glow โ ููุฑูุง ููุงู ุจุฑุง ุญุณ ูุงูุชุฒ
                            ]
    """
    PR = f"""
                                       ูุชู  ุฑู ุจู ุตูุฑุช ฺฉ ูพุฑุงูุช ููููู ุงูฺฏูุณ ุจู ุฌูุช ุชููุฏ ฺฉ ุนฺฉุณ ุจุงุฒููุณ ู ูฺ ุชุบุฑ ุชู ูููููุด ูุฏู:
                                       [ุฏุณุชูุฑ: ูฺ ููุช ุญุฏุงฺฉุซุฑ ุทูู ูพุฑุงูุช ูุจุงุฏ ุจุด ุงุฒ 2048 ฺฉุงุฑุงฺฉุชุฑ ุจุดู] 
                                       ูฺฉุชู : ูพุฑุงูุช ุฑู ูุชูู ุจู ุดุฑุท ุนูุถ ูุดุฏู ุฎูุงุณุชู ู ููููู ฺฏุณุชุฑุด ุจุฏ ู ูพุฑุงููู ูพุฑุงูุช ุดุฑุงุท ุฑู ฺฉุงูู ุชูุถุญ ุจุฏ
                                       ุจุงุฏ ุฎูุงุณุชู ฺฉุงุฑุจุฑ ุงุฒ ุงู ูพุฑุงูุช ุฏุฑฺฉ ฺฉู ู ูพุณ ุงุฒ ุฏุฑฺฉ ุฎูุงุณุชู ฺฉุงุฑุจุฑ ุ ูพุฑุงูุช ุฑู ูพุฑุงููู ุฎูุงุณุชู ฺฉุงุฑุจุฑ ฺฏุณุชุฑุด ุจุฏ
                                       ูโุชูู ุชุง ุฌุง ููฺฉู ุจู ูุณุจุช ูพุฑุงูุช ุดุฑุงุท ูุญุท ุชุตูุฑ ุฎูุงุณุชู ุดุฏู ุชูุตู ฺฉู ู ุฎูุฏุช ุฑู ุฏุฑ ุดุฑุงุท ูพุฑุงูุช ุจุฒุงุฑ ู ฺฉุงูู ุชูุตู ฺฉู ุจุง ุชูุงู ุชฺฉูฺฉ ูุง ุทุฑุงุญ
                                       ูุชูู ูพุฑุงูุช ุฑู ุฒุจุง ุณุงุฒ ฺฉู ู ุงุฒ ุงููุงุน ุดุฑุงุท ุจุฑุง ุฒุจุงุชุฑ ุดุฏู ุจูุฑู ุจฺฏุฑ
                                       ูุชูู ูุชูุงุณุจ ุจุง ููุถูุน ูพุฑุงูุช ูุถุง ุณุงุฒ ุญุฑูู ุง ุงูุฌุงู ุจุฏ
                                       ูุชูู ูุชูุงุณุจ ุจุง ููุถูุน ูพุฑุงูุช ุจุงูุช ุชูุตู ฺฉู ู ุจู ุชูุตู ุฌุฒุฆุงุช ุจุณุงุฑ ุฏูุช ฺฉู
                                       ูุชูู ุญุงูุช ูฺฏุงู ุณูฺู ู ฺฉุงุฑุงฺฉุชุฑ ูุง ู ุฒุงูู ุฏูุฑุจู ุฑู ุชู ุจูุชุฑู ุญุงูุช ุชูุตู ฺฉู
                                       ูุชูู ูพุฑุงูุช ุจุฑุง ูพุฑุงูุช ุดุฑุงุท ููุฑ ูพุฑุฏุงุฒ ุญุฑูู ุง ุชูุตู ฺฉู
                                       ูุชูู ุจุฑุง ูพุฑุงูุชู ฺุณุช ูุง ู ุญุงูุงุช ุจุฑุง ุงููุง ุญุณ ูุงูุน ูพุฑุงูุช ุชูุตู ฺฉู
                                       ูุชูู ุงุฒ ุฒุงูู ูุง ูุชูุงูุช ุจู ูพุฑุงูุช ูฺฏุงู ฺฉู
                                       ูุชูู ููฺฉูุณ ูพุฑุงูุช ุฑู ุฑู ุณูฺู ุงุตู ุจุฒุงุฑ
                                       ูุชูู ุจูุชุฑู ุฑูฺฏ ุจูุฏ ุจุฑุง ุงุฌุฒุง ูพุฑุงูุช ุงูุชุฎุงุจ ฺฉู
                                       ูุชูู ุงุฒ ุฑูฺฏ ูุง ูฺฉูู ุญุฑูู ุง ุงุณุชูุงุฏู ฺฉู
                                       ูุชูู ุจูุชุฑู ูฺฉุงู ูุงุฑู ุจุฑุง ูพุฑุงูุช ุจุงุฒฺฏู ฺฉู
                                       ูุชูู ุณุจฺฉ ุชููุฏ ุนฺฉุณ ุฑู ูุชูุงุณุจ ุจุง ุงูุชุฑู ุฎุฑูุฌ ุงูุชุฎุงุจ ฺฉู ุงุฒ ุฎูุฏุช
                                       ุชุฑุฌุญุง ุณุจฺฉ ุฎุฑูุฌ ููุงุด ู ุงูุซุงูุด ูุจุงุดู 
                                       ููู:
                                    [ูุฌ ูพุฑุงูุช ุจุง ุณุจฺฉ ฺฉูุฏฺฉุงูู ู ุง 2 ุจุนุฏ ฺฉูุฏฺฉุงูู ู ฺฉุงุฑุชูู ู ุง ฺูุฏ ุฑูฺฏ ุซุงุจุช ุงุฌุงุฏ ูฺฉู]
                                    ูฺฉุชู:  ุงฺฏู ุฎูุงุณุช ุนฺฉุณ ุฒู ุจุณุงุฒุ ุจู ูฺ ุนููุงู ูุจุงุฏ ุฎุท ุณูู ูุดุฎุต ุจุงุดู ู ูุจุงุณ ุจุงุฏ ุจุงูุง ุชุฑ ุงุฒ ุณูู ุฒู ุจุงุดู ุญุชูุง
                                       ุชุฑุฌุญุง ุณุจฺฉ ูุง ูุงูุน ู ุงููุดู ู 3 ุจุนุฏ ู ุจู ุงู ูุง ุฑู ุงูุชุฎุงุจ ฺฉู
                                       ูุชูู ุชู ูพุฑุงูุช ููุณุช ุงุฒ ุฒุจุงู ุจุฏู ุจูุฑู ุจฺฏุฑ ู ุจุฑุง ฺฉุงุฑุงฺฉุชุฑ ูุง ุฒุจุงู ุจุฏู ุฑู ฺฉุงูู ุชูุตู ฺฉู
                                       ูุชูู ุญุงู ู ููุง ูพุฑุงูุช ูุชูุงุณุจ ุจุง ุจูุชุฑู ุฎุฑูุฌ ฺฉุงูู ุชูุตู ฺฉู
                                       ูุชูู ุจุฑุง ุจูุชุฑู ุฎุฑูุฌ ุงุฒ ฺฉุงุฑ ุจู ูพุฑุงูุช ุฌูุช ุจุฏ ู ุฑูุดู ุณุงุฒ ฺฉู
                                       ูุชูู ุจู ุญุงูุช ูู ู ููุน ูพูุดุด ุฏูุช ฺฉู ู ููู ุชูุงุดุช ุจุฑุง ุชูุตู ุฑุฒ ุชุฑู ุฌุฒุฆุงุช ุจูุฑู ุจฺฏุฑ
                                       ููุดู ุณุน ฺฉู 1 ุณูฺู ุฏุงุดุชู ุจุงุด ุชู ูพุฑุงูุช ู ุชูุฑฺฉุฒ ุงุตู ุฑู ุณูฺู ุงุตู ููุท ุจุงุดู
                                       ูุชูู ูุชูุงุณุจ ุจุง ุดุฑุงุท ุจู ุชูุตู ุงููุงู ูุง ุจูพุฑุฏุงุฒ ุชุง ุฎุฑูุฌ ฺุดู ููุงุฒ ุชุฑ ุจุดู
                                       ููู : ุงุฒ ฺฉููุงุช ูพุฑ ูุนูุง ู ุฏุงุฑุง ูุนูุง ุฏูู ุงูฺฏูุณ ุจุฑุง ุชูุตู ุงุณุชูุงุฏู ฺฉู
                                       ุงุฒ ุญุงูุช ุชูุซู ู ูุซุงู ุฒุฏู ุจุฑุง ุงูุชูุงู ุจูุชุฑ ููููู ูพุฑุงูุช ุจูุฑู ุจฺฏุฑ
                            ุฎู ููู : ุงูู ุนููุงู ูพุฑุงูุช ุฑู ุฏุฑฺฉ ฺฉู ู ุฎูุงุณุชู ูพุฑุงูุช ุจููู ู ุจุนุฏ ุงุฒ ุชฺฉูฺฉ ูุง ุจุงูุง ูุชูุงุณุจ ุจุง ุฎูุงุณุชู ู ุฏุฑ ุตูุฑุช ูุงุฒ ุงุณุชูุงุฏู ฺฉู
                                       ููู: ูุจุงุณ ุฒูุงู ุชู ูพุฑุงูุช ุจุงุฏ ฺฉุงููุง ูพูุดุฏู ุชุนุฑู ุดู ุญุชูุง ู ุจุฑุง ุฒูุงู ูพูุดุด ูุง ุจููุฏ ุงุฒ ฺฏูู ุชุง ูพุง ุชุนุฑู ฺฉู
                                       ูฺฉุชู ููู : ุดุฑุงุท ุชุนุฑู ุดุฏู ุฏุฑ ูพุฑุงูุช ุจุฑ ูุฑ ฺุฒ ุงููุช ุฏุงุฑู ู ูุจุงุฏ ุชูุตูุช ุจุง ุดุฑุงุท ุชุนุฑู ุดุฏู ุฏุฑ ุชุถุงุฏ ุจุงุดู
                                       ุจุงุฏ ุจุฑุง ูพุฑ ฺฉุฑุฏูุด ูุชูุงูุถ ูพุฑุงูุช ุฑู ุจฺฏ ู ููฺูู ุฑู ูฺฺฏ ูุง ุงุดุชุจุงู ฺฉู ฺฉ ุชุตูุฑ ูโุชูุงูุฏ ุฏุงุดุชู ุจุงุดุฏ ุชูุตู ฺฉู
                                       ุณุงุฎุชุงุฑ ุฌุณูู ฺฉู ุจุงุฏ ุจู ูู ุจุฏ :
                                       {base_json}
                                       ุชูุฌู : ููุท ู ููุท ู ููุท ุฏููุง ูุซู ุฌุณูู ุจุงูุง ุฑู ุฏุฑ ููุงุช ุจูู ุจุฏู ู ูุงุฒ ุจู ูฺ ุชูุถุญ ูุฏุงุฑู ู ุฏูุช ฺฉู ุณุงุฎุชุงุฑ ุฌุณูู ุจุง ูุงุตูู ุฎุฑุงุจ ูฺฉู ุฏููุง ุฌุณูู ุฎุฑูุฌ ุฑู ุจุง ูุฑูุช ุฌุณูู ุตุญุญ ูุงุฒ ุฏุงุฑู
                                       ุงุฒ ุงุจุนุงุฏ ฺฉุงููุง ุงุณุชุงูุฏุงุฑุฏ ุงุณุชูุงุฏู ฺฉู
                                       ูฺฉุชู : ุชู ูุชู ูพุฑุงูุช ุชู ุฌุณูู ุงุตูุง ูุฑู ุฎุท ุจุนุฏ ู ูุชู ฺฉูพุงุฑฺู ู ุจุฏูู ูฺ ูุงุตูู ุง ุจุงุดู
                                       ููู ุชุฑู ูฺฉุชู ฺฉู ฺฉุงูู ุจุงุฏ ุฏูุช ฺฉู:
                                       ุจู ูฺ ุนููุงู ุชู ูุชู ูพุฑุงูุชุช ูุจุงุฏ ูุงุตูู ุฑูุชู ุจู ุฎุท ุจุนุฏ ุจุงุดู ฺูู ุณุงุฎุชุงุฑ ุฌุณูู ุฎุฑุงุจ ูุดู
                                       ุฏุณุชูุฑ ููุง : ฺฉ ุขุฑุงู ุจู ุชุนุฏุงุฏ ุชุตุงูุฑ ุฏุฑุฎูุงุณุช ฺฉุงุฑุจุฑ ฺฉู ุชู ูุชู ูพุฑุงูุช ฺฏูุชู ุดุฏู ุงุฒ ุฌุณูู ุจุณุงุฒ ู ุงฺฏู ูฺฏูุชู ุจูุฏ ุชู ูพุฑุงูุช 6 ุชุง ุฏุฑ ูุธุฑ ุจฺฏุฑ ู ุฏูุช ฺฉู ุญุชูุง ุชุนุฏุงุฏ ุฑู ุงุฒ ูุชู ูพุฑุงูุช ูพุฏุง ฺฉู ู ุงฺฏู ุจุดุชุฑ ุงุฒ 10 ฺฏูุชู ุดุฏู ุจูุฏ ุชู 10 ุชุง ุจุณุงุฒ
                                       ุงฺฏู ฺฉุงุฑุจุฑ ุดุฑุงุท ูุฑ ุชุตูุฑ ุฑู ุชูุตู ฺฉุฑุฏู ุจูุฏ ุ ูพุฑุงูุช ฺฉู ูโุณุงุฒ ุจุงุฏ ุจุง ุดุฑุงุท ุชูุตู ุจุฑุง ูุฑ ุนฺฉุณ ุฏูู ุจุงุดุฏ ู ูุฑ ูพุฑุงูุช ุฑู ุจุง ูพุฑุงูุช ุณุงุฑ ุชุตุงูุฑ ุชุฑฺฉุจ ูฺฉู ู ุจุฑุง ูุฑ ุนฺฉุณ ูพุฑุงูุช ููฺฉ ุฎูุฏุด ุงุฌุงุฏ ฺฉู
                                       ุชุนุฏุงุฏ ุชุตุงูุฑ ุฑู ุชู ูพุฑุงูุช ูุง ุฏุฎู ูฺฉู ู ูุฑ ูพุฑุงูุช ุจุงุฏ ุฑู ุณูฺู ููฺฉ ุฎูุฏุด ุชูุฑฺฉุฒ ุฏุงุดุชู ุจุงุดุฏ
                                       ูฺฉุชู ุฎู ููู : ูฺ ููุช ุทูู ุขุฑุงู ุจุดุชุฑ ุงุฒ 10 ูุจุงุฏ ุจุดู ู ุญุฏุงฺฉุซุฑ 10 ุชุง ุจุงุดู
                                       ูฺฉุชู : ููุฏุงุฑ ูพุฑุงูุช ุชู ูฺ ุขุชู ุงุฒ ุขุฑุงู ูุจุงุฏ ุจุง ููุฏุงุฑ ูพุฑุงูุช ุณุงุฑ ุขุฑุงู ูุง ุจุฑุงุจุฑ ุจุงุดู ู ุจุงุฏ ุจุฑุง ูุฑ ุขุชู ุงุฒ ุขุฑุงู ฺฉ ูพุฑุงูุช ููฺฉ ุจุณุงุฒ
                                       ุญุงู ุขุฑุงู ุฑู ุฏุงุฎู ุฌุณูู ุฒุฑ ูุฑุงุฑ ุจุฏู:
                                       {base_json2}
                                       ููุฏุงุฑ ฺฉูพุดู ุฑู ุจุง ู ุชูุถุญ ฺฉุงูู ู ุชูุตู ุชุตุงูุฑ ฺฉู ุณุงุฎุช ุจู ุฒุจุงู ูุงุฑุณ ูพุฑ ฺฉู 
                                       ูุชูู ุจุง ฺฉุงุฑุจุฑ ูพุดููุงุฏ ุจุฏ ุชู ูพุฑุงูุช ุจุนุฏุด ุงุฒุช ฺ ุจุฎูุงุฏ ุฏุฑ ููุถูุนุงุช ูุฎุชูู ู ูุดุงุจู ุจุง ูพุฑุงูุช ุดูุงุฑู 1 ฺฉุงุฑุจุฑ
                                       ูุชูู ุงุฒ ฺฉุงุฑุจุฑ ุจุฎุงุทุฑ ุตููุด ุชุนุฑู ฺฉู
                                       ูุชูู ู ูพุฑุงูุช ูุดุงุจู ูพุฑุงูุช ฺฉุงุฑุจุฑ ูู ุจู ุตูุฑุช ุจูุจูุฏ ุงูุชู ุจู ฺฉุงุฑุจุฑ ูพุดููุงุฏ ุจุฏ ุจุฑุง ุฒุจุงุชุฑ ุดุฏู ุชุตุงูุฑุด ู ูพุดููุงุฏุช ูุงุฑุณ ุจุงุดู
                                       ูุชูู ุงููุงุน ูุฎุชูู ูพุฑุงูุช ุ ูุดุงุจู ูพุฑุงูุช ฺฉุงุฑุจุฑ ุ ุจูุด ูพููุงุฏ ุจุฏ ูู ูพุดููุงุฏุงุชุช ุจุงุฏ ฺฉุงููุง ูุงุฑุณ ุจุงุดู
                                       ูุชูู ุง ุดูุงุฎุช ุตููู ฺฉุงุฑุจุฑ ฺฉ ูพุฑุงูุช ูุชูุงูุช ุงุฒ ูพุฑุงูุช ูุนู ฺฉุงุฑุจุฑ ูพุดููุงุฏ ุจุฏ ู ุจุฎูุง ฺฉู ุงูู ูู ุงูุชุญุงู ฺฉูู
                                       ูุชูู ฺฉ ุงุฒ ูพุฑุงูุช ูุง ูุณุช ูพุดููุงุฏ ุฑู ุจุง ุฎูุงูุช ุจุดุชุฑ ุจู ฺฉุงุฑุจุฑ ุจฺฏ
                                       ูุชูู ุงุฑุงุฏุงุช ูพุฑุงูุช ฺฉุงุฑุจุฑ ุฑู ุจูุด ุจฺฏ ู ุฑุงูููุงุด ฺฉู ฺุฌูุฑ ูพุฑุงูุช ุจูุชุฑ ุจููุณุฏ ู ุชฺฉูฺฉ ูุง ูพุฑุงูุช ููุณ ุงุฏุด ุจุฏ
                                       ุจุงุฏ ฺฉุงุฑุจุฑ ุจู ููู ูุฑ ุจุฎุด ุงุฒ ูุชู ุฏุงุฑ ุชูุตู ูโฺฉู ูพุดููุงุฏ ูุฏ ู ุง ุชุนุฑู ูโฺฉู ูพุณ ุจุงุฏ ูุชู ฺฏูุง ู ูุงุถุญ ู ุจุฏูู ุงุจูุงู ุจุงุดู
                                       ูุชูู ุงุฒ ุงููุฌโูุง ููุงุณุจ ุจุง ููุถูุน ูพุฑุงูุช ุจุฑุง ุฒุจุงุณุงุฒ ุงุณุชูุงุฏู ฺฉู
                                       ุชุง ุฌุง ููฺฉู ุงุฒ ุงููุฌโูุง ุจุฑุง ููุชูู ฺฉุฑุฏู ุญุณ ุฎูุจ ุจู ฺฉุงุฑุจุฑ ุจูุฑู ุจฺฏุฑ
                                       ุญุชูุง ุจุงุฏ ุงููุฌ ู 1 ูพุฑุงูุช ูพุดููุงุฏ ุญุฏุงูู ุจู ฺฉุงุฑุจุฑ ฺฏูุชู ุจุดู
                                       ุจู ฺฉุงุฑุจุฑ ูุชู ูุดุงุจู ูุชู ุฒุฑ ุจุง ุฒุจุง ุณุงุฒ ู ุฎูุงูุช ุจุดุชุฑ ุจฺฏู:
                                       {mass}
                                         """
    ch = """
    ุฏุณุชูุฑ : ุฌุณูู ฺฉู ุชููุฏ ูฺฉู 2 ุจุงุฑ ุจุฑุณ ฺฉุงูู ฺฉู ูุญุชูุง prompts ู ูุฑ ฺฉุฌุง ุชู ูพุฑุงูุช ูุง ุตุญุจุช ุงุฒ ุฎุงูู ุจูุฏ ูุงุณุด ฺฉ ูพูุดุด ุจููุฏ ุงุฒ ฺฏูู ุชุง ููฺฉ ูพุง ุจุง ูุงูุชู ุฏุงูู ุจููุฏ ุชูุตู ฺฉู
    """

    payload = {
        "contents": [
            {
                "role": "user",
                "parts": [
                    {
                        "text": f"Make the outputs in JSON format. {base_json2}"
                    } ,
                    {
                        "text": nokte
                    },
                    {
                        "text": list1
                    },
                    {
                        "text": PR
                    },
                    {
                        "text": ch
                    }
                ]
            },
            {"role": "user",
            "parts": [{"text": user_text}]
        }]
    }
    async with aiohttp.ClientSession() as session:
        async with session.post(GEMINI_ENDPOINT, json=payload) as response:
            response.raise_for_status()
            gemini_response = await response.json()
            generated_text = gemini_response['candidates'][0]['content']['parts'][0]['text']
            prompts_bais = fix_and_parse_json(generated_text)
            prompts_array = prompts_bais['prompts']
            prompts_caption = prompts_bais['caption']
            prompts_Advertising = Advertising
            if not isinstance(prompts_array, list):
                raise ValueError("ุฎุฑูุฌ ุจุงุฏ ฺฉ ูุณุช ุจุงุดุฏุ ูู ฺฉ ุฑุดุชู ุง ฺุฒ ุฏฺฏุฑ.")
            if nudity == False:
                for prompt in prompts_array:
                    if not isinstance(prompt, dict):
                        raise ValueError("ูุฑ ุขุชู ุฏุฑ ูุณุช ุจุงุฏ ฺฉ ุฏฺฉุดูุฑ ุจุงุดุฏ.")
            return prompts_array, prompts_caption, prompts_Advertising
